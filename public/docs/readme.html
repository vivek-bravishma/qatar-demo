<!DOCTYPE html>
<html>

<head>

<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>README</title>


<style type="text/css">
body {
  font-family: Helvetica, arial, sans-serif;
  font-size: 14px;
  line-height: 1.6;
  padding-top: 10px;
  padding-bottom: 10px;
  background-color: white;
  padding: 30px; }

body > *:first-child {
  margin-top: 0 !important; }
body > *:last-child {
  margin-bottom: 0 !important; }

a {
  color: #4183C4; }
a.absent {
  color: #cc0000; }
a.anchor {
  display: block;
  padding-left: 30px;
  margin-left: -30px;
  cursor: pointer;
  position: absolute;
  top: 0;
  left: 0;
  bottom: 0; }

h1, h2, h3, h4, h5, h6 {
  margin: 20px 0 10px;
  padding: 0;
  font-weight: bold;
  -webkit-font-smoothing: antialiased;
  cursor: text;
  position: relative; }

h1:hover a.anchor, h2:hover a.anchor, h3:hover a.anchor, h4:hover a.anchor, h5:hover a.anchor, h6:hover a.anchor {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA09pVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoMTMuMCAyMDEyMDMwNS5tLjQxNSAyMDEyLzAzLzA1OjIxOjAwOjAwKSAgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OUM2NjlDQjI4ODBGMTFFMTg1ODlEODNERDJBRjUwQTQiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OUM2NjlDQjM4ODBGMTFFMTg1ODlEODNERDJBRjUwQTQiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo5QzY2OUNCMDg4MEYxMUUxODU4OUQ4M0REMkFGNTBBNCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo5QzY2OUNCMTg4MEYxMUUxODU4OUQ4M0REMkFGNTBBNCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PsQhXeAAAABfSURBVHjaYvz//z8DJYCRUgMYQAbAMBQIAvEqkBQWXI6sHqwHiwG70TTBxGaiWwjCTGgOUgJiF1J8wMRAIUA34B4Q76HUBelAfJYSA0CuMIEaRP8wGIkGMA54bgQIMACAmkXJi0hKJQAAAABJRU5ErkJggg==) no-repeat 10px center;
  text-decoration: none; }

h1 tt, h1 code {
  font-size: inherit; }

h2 tt, h2 code {
  font-size: inherit; }

h3 tt, h3 code {
  font-size: inherit; }

h4 tt, h4 code {
  font-size: inherit; }

h5 tt, h5 code {
  font-size: inherit; }

h6 tt, h6 code {
  font-size: inherit; }

h1 {
  font-size: 28px;
  color: black; }

h2 {
  font-size: 24px;
  border-bottom: 1px solid #cccccc;
  color: black; }

h3 {
  font-size: 18px; }

h4 {
  font-size: 16px; }

h5 {
  font-size: 14px; }

h6 {
  color: #777777;
  font-size: 14px; }

p, blockquote, ul, ol, dl, li, table, pre {
  margin: 15px 0; }

hr {
  background: transparent url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAECAYAAACtBE5DAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OENDRjNBN0E2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OENDRjNBN0I2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo4Q0NGM0E3ODY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo4Q0NGM0E3OTY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PqqezsUAAAAfSURBVHjaYmRABcYwBiM2QSA4y4hNEKYDQxAEAAIMAHNGAzhkPOlYAAAAAElFTkSuQmCC) repeat-x 0 0;
  border: 0 none;
  color: #cccccc;
  height: 4px;
  padding: 0;
}

body > h2:first-child {
  margin-top: 0;
  padding-top: 0; }
body > h1:first-child {
  margin-top: 0;
  padding-top: 0; }
  body > h1:first-child + h2 {
    margin-top: 0;
    padding-top: 0; }
body > h3:first-child, body > h4:first-child, body > h5:first-child, body > h6:first-child {
  margin-top: 0;
  padding-top: 0; }

a:first-child h1, a:first-child h2, a:first-child h3, a:first-child h4, a:first-child h5, a:first-child h6 {
  margin-top: 0;
  padding-top: 0; }

h1 p, h2 p, h3 p, h4 p, h5 p, h6 p {
  margin-top: 0; }

li p.first {
  display: inline-block; }
li {
  margin: 0; }
ul, ol {
  padding-left: 30px; }

ul :first-child, ol :first-child {
  margin-top: 0; }

dl {
  padding: 0; }
  dl dt {
    font-size: 14px;
    font-weight: bold;
    font-style: italic;
    padding: 0;
    margin: 15px 0 5px; }
    dl dt:first-child {
      padding: 0; }
    dl dt > :first-child {
      margin-top: 0; }
    dl dt > :last-child {
      margin-bottom: 0; }
  dl dd {
    margin: 0 0 15px;
    padding: 0 15px; }
    dl dd > :first-child {
      margin-top: 0; }
    dl dd > :last-child {
      margin-bottom: 0; }

blockquote {
  border-left: 4px solid #dddddd;
  padding: 0 15px;
  color: #777777; }
  blockquote > :first-child {
    margin-top: 0; }
  blockquote > :last-child {
    margin-bottom: 0; }

table {
  padding: 0;border-collapse: collapse; }
  table tr {
    border-top: 1px solid #cccccc;
    background-color: white;
    margin: 0;
    padding: 0; }
    table tr:nth-child(2n) {
      background-color: #f8f8f8; }
    table tr th {
      font-weight: bold;
      border: 1px solid #cccccc;
      margin: 0;
      padding: 6px 13px; }
    table tr td {
      border: 1px solid #cccccc;
      margin: 0;
      padding: 6px 13px; }
    table tr th :first-child, table tr td :first-child {
      margin-top: 0; }
    table tr th :last-child, table tr td :last-child {
      margin-bottom: 0; }

img {
  max-width: 100%; }

span.frame {
  display: block;
  overflow: hidden; }
  span.frame > span {
    border: 1px solid #dddddd;
    display: block;
    float: left;
    overflow: hidden;
    margin: 13px 0 0;
    padding: 7px;
    width: auto; }
  span.frame span img {
    display: block;
    float: left; }
  span.frame span span {
    clear: both;
    color: #333333;
    display: block;
    padding: 5px 0 0; }
span.align-center {
  display: block;
  overflow: hidden;
  clear: both; }
  span.align-center > span {
    display: block;
    overflow: hidden;
    margin: 13px auto 0;
    text-align: center; }
  span.align-center span img {
    margin: 0 auto;
    text-align: center; }
span.align-right {
  display: block;
  overflow: hidden;
  clear: both; }
  span.align-right > span {
    display: block;
    overflow: hidden;
    margin: 13px 0 0;
    text-align: right; }
  span.align-right span img {
    margin: 0;
    text-align: right; }
span.float-left {
  display: block;
  margin-right: 13px;
  overflow: hidden;
  float: left; }
  span.float-left span {
    margin: 13px 0 0; }
span.float-right {
  display: block;
  margin-left: 13px;
  overflow: hidden;
  float: right; }
  span.float-right > span {
    display: block;
    overflow: hidden;
    margin: 13px auto 0;
    text-align: right; }

code, tt {
  margin: 0 2px;
  padding: 0 5px;
  white-space: nowrap;
  border: 1px solid #eaeaea;
  background-color: #f8f8f8;
  border-radius: 3px; }

pre code {
  margin: 0;
  padding: 0;
  white-space: pre;
  border: none;
  background: transparent; }

.highlight pre {
  background-color: #f8f8f8;
  border: 1px solid #cccccc;
  font-size: 13px;
  line-height: 19px;
  overflow: auto;
  padding: 6px 10px;
  border-radius: 3px; }

pre {
  background-color: #f8f8f8;
  border: 1px solid #cccccc;
  font-size: 13px;
  line-height: 19px;
  overflow: auto;
  padding: 6px 10px;
  border-radius: 3px; }
  pre code, pre tt {
    background-color: transparent;
    border: none; }

sup {
    font-size: 0.83em;
    vertical-align: super;
    line-height: 0;
}

kbd {
  display: inline-block;
  padding: 3px 5px;
  font-size: 11px;
  line-height: 10px;
  color: #555;
  vertical-align: middle;
  background-color: #fcfcfc;
  border: solid 1px #ccc;
  border-bottom-color: #bbb;
  border-radius: 3px;
  box-shadow: inset 0 -1px 0 #bbb
}

* {
	-webkit-print-color-adjust: exact;
}
@media screen and (min-width: 914px) {
    body {
        width: 854px;
        margin:0 auto;
    }
}
@media print {
	table, pre {
		page-break-inside: avoid;
	}
	pre {
		word-wrap: break-word;
	}
  body {
    padding: 2cm; 
  }
}
</style>

<style type="text/css">
/**
 * prism.js default theme for JavaScript, CSS and HTML
 * Based on dabblet (http://dabblet.com)
 * @author Lea Verou
 */

code[class*="language-"],
pre[class*="language-"] {
	color: black;
	background: none;
	text-shadow: 0 1px white;
	font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
	text-align: left;
	white-space: pre;
	word-spacing: normal;
	word-break: normal;
	word-wrap: normal;
	line-height: 1.5;

	-moz-tab-size: 4;
	-o-tab-size: 4;
	tab-size: 4;

	-webkit-hyphens: none;
	-moz-hyphens: none;
	-ms-hyphens: none;
	hyphens: none;
}

pre[class*="language-"]::-moz-selection, pre[class*="language-"] ::-moz-selection,
code[class*="language-"]::-moz-selection, code[class*="language-"] ::-moz-selection {
	text-shadow: none;
	background: #b3d4fc;
}

pre[class*="language-"]::selection, pre[class*="language-"] ::selection,
code[class*="language-"]::selection, code[class*="language-"] ::selection {
	text-shadow: none;
	background: #b3d4fc;
}

@media print {
	code[class*="language-"],
	pre[class*="language-"] {
		text-shadow: none;
	}
}

/* Code blocks */
pre[class*="language-"] {
	padding: 1em;
	margin: .5em 0;
	overflow: auto;
}

:not(pre) > code[class*="language-"],
pre[class*="language-"] {
	background: #f5f2f0;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
	padding: .1em;
	border-radius: .3em;
	white-space: normal;
}

.token.comment,
.token.prolog,
.token.doctype,
.token.cdata {
	color: slategray;
}

.token.punctuation {
	color: #999;
}

.namespace {
	opacity: .7;
}

.token.property,
.token.tag,
.token.boolean,
.token.number,
.token.constant,
.token.symbol,
.token.deleted {
	color: #905;
}

.token.selector,
.token.attr-name,
.token.string,
.token.char,
.token.builtin,
.token.inserted {
	color: #690;
}

.token.operator,
.token.entity,
.token.url,
.language-css .token.string,
.style .token.string {
	color: #a67f59;
	background: hsla(0, 0%, 100%, .5);
}

.token.atrule,
.token.attr-value,
.token.keyword {
	color: #07a;
}

.token.function {
	color: #DD4A68;
}

.token.regex,
.token.important,
.token.variable {
	color: #e90;
}

.token.important,
.token.bold {
	font-weight: bold;
}
.token.italic {
	font-style: italic;
}

.token.entity {
	cursor: help;
}
</style>


</head>

<body>

<h1 id="toc_0">AvMessagingSdk Web Messenger</h1>

<p>The AvMessagingSdk Web Messenger will add live web messaging to your website or web app.</p>

<h2 id="toc_1">Usage</h2>

<h3 id="toc_2">Script Tag</h3>

<p>Add the following code towards the end of the <code>head</code> section on your page and replace <code>&lt;integration-id&gt;</code> with your integration id at the end of the script.</p>

<!-- prettier-ignore -->

<div><pre><code class="language-markup">&lt;script&gt;
    !function(e,n,t,r){function s(){try{var e;if((e=&quot;string&quot;==typeof this.response?JSON.parse(this.response):this.response).url){var t=n.getElementsByTagName(&quot;script&quot;)[0],r=n.createElement(&quot;script&quot;);r.async=!0,r.src=e.url,t.parentNode.insertBefore(r,t)}}catch(e){}}var o,p,a,i=[],c=[];e[t]={init:function(){o=arguments;var e={then:function(n){return c.push({type:&quot;t&quot;,next:n}),e},catch:function(n){return c.push({type:&quot;c&quot;,next:n}),e}};return e},on:function(){i.push(arguments)},render:function(){p=arguments},destroy:function(){a=arguments}},e.__onWebMessengerHostReady__=function(n){if(delete e.__onWebMessengerHostReady__,e[t]=n,o)for(var r=n.init.apply(n,o),s=0;s&lt;c.length;s++){var u=c[s];r=&quot;t&quot;===u.type?r.then(u.next):r.catch(u.next)}p&amp;&amp;n.render.apply(n,p),a&amp;&amp;n.destroy.apply(n,a);for(s=0;s&lt;i.length;s++)n.on.apply(n,i[s])};var u=new XMLHttpRequest;u.addEventListener(&quot;load&quot;,s),u.open(&quot;GET&quot;,&quot;http://localhost:3000/cdnPackage/loader.json&quot;,!0),u.responseType=&quot;json&quot;,u.send()}(window,document,&quot;AvMessagingSdk&quot;);
&lt;/script&gt;</code></pre></div>

<p>then initialize the Web Messenger by placing this snippet towards the end of the <code>body</code> section of your page.</p>

<div><pre><code class="language-markup">&lt;script&gt;
    AvMessagingSdk.init({integrationId: &#39;&lt;integration-id&gt;&#39;}).then(function() {
        // Your code after init is complete
    });
&lt;/script&gt;</code></pre></div>

<h2 id="toc_3">Browser support</h2>

<p>Web Messenger supports all popular browsers.</p>

<h4 id="toc_4">Desktop versions</h4>

<ul>
<li>  Chrome: Latest and one major version behind</li>
<li>  Edge: Latest and one major version behind</li>
<li>  Firefox: Latest and one major version behind</li>
<li>  Internet Explorer: 11+</li>
<li>  Safari: Latest and one major version behind</li>
</ul>

<h4 id="toc_5">Mobile versions</h4>

<ul>
<li>  Stock browser on Android 4.1+</li>
<li>  Safari on iOS 8+</li>
</ul>

<h4 id="toc_6">Other browsers</h4>

<p>Web Messenger is likely compatible with other and older browsers but we only test against the versions above.</p>

<h2 id="toc_7">API</h2>

<h3 id="toc_8">Individual functions</h3>

<h4 id="toc_9">init(options)</h4>

<p>Initializes the AvMessagingSdk widget in the web page using the specified options. It returns a promise that will resolve when the Web Messenger is ready. Note that except<code>on</code> and <code>off</code>, all methods needs to be called after a successful <code>init</code>.</p>

<h5 id="toc_10">Options</h5>

<table>
<thead>
<tr>
<th>Option</th>
<th>Optional?</th>
<th>Default value</th>
<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
<td>appId</td>
<td>Yes</td>
<td>-</td>
<td>Your app id</td>
</tr>
<tr>
<td>integrationId</td>
<td>No</td>
<td>-</td>
<td>Your integration id</td>
</tr>
<tr>
<td>region</td>
<td>Yes</td>
<td>-</td>
<td>The target region in which the app is located.</td>
</tr>
<tr>
<td>userId</td>
<td>Yes</td>
<td>-</td>
<td>Optional. User&rsquo;s id, which can be passed in <code>init()</code> as an alternative to <code>login()</code> (see <a href="#authenticating-the-user-init-vs-login">below</a>)</td>
</tr>
<tr>
<td>jwt</td>
<td>Yes</td>
<td>-</td>
<td>Optional. User&rsquo;s authentication token, which can be passed in <code>init()</code> as an alternative to <code>login()</code> (see <a href="#authenticating-the-user-init-vs-login">below</a>)</td>
</tr>
<tr>
<td>authCode</td>
<td>Yes</td>
<td>-</td>
<td>An auth code for linking to an existing conversation</td>
</tr>
<tr>
<td>locale</td>
<td>Yes</td>
<td><code>en-US</code></td>
<td>Locale used for date formatting using the <code>&lt;language&gt;-&lt;COUNTRY&gt;</code> format. Language codes can be found <a href="https://en.wikipedia.org/wiki/List_of_ISO_639-1_codes">here</a> and country codes <a href="https://en.wikipedia.org/wiki/ISO_3166-1_alpha-2">here</a>. <br /> **Note 1 : ** The country part is optional, and if a country is either not recognized or supported, it will fallback to using the generic language. If the language isn&rsquo;t supported, it will fallback to <code>en-US</code>. <br /> <strong>Note 2:</strong> this is <u>only</u> used for date formatting and doesn&rsquo;t provide built-in translations for Web Messenger.</td>
</tr>
<tr>
<td>soundNotificationEnabled</td>
<td>Yes</td>
<td><code>true</code></td>
<td>Enables the sound notification for new messages</td>
</tr>
<tr>
<td>imageUploadEnabled</td>
<td>Yes</td>
<td><code>true</code></td>
<td>Enables the image upload feature. (deprecated: use menuItems.imageUpload; if this option is <code>false</code>, it will disable <code>menuItems.imageUpload</code> and <code>menuItems.fileUpload</code>)</td>
</tr>
<tr>
<td>fixedIntroPane</td>
<td>Yes</td>
<td><code>false</code></td>
<td>When enabled, the introduction pane will be pinned at the top of the conversation instead of scrolling with it.</td>
</tr>
<tr>
<td>embedded</td>
<td>Yes</td>
<td>False</td>
<td>Tells the widget it will be embedded. (see Embedded section below)</td>
</tr>
<tr>
<td>displayStyle</td>
<td>Yes</td>
<td><code>button</code></td>
<td>Choose how the messenger will appear on your website. Must be either <code>button</code> or <code>tab</code>.</td>
</tr>
<tr>
<td>buttonIconUrl</td>
<td>Yes</td>
<td>-</td>
<td>When the <code>displayStyle</code> is <code>button</code>, you have the option of selecting your own button icon. The image must be at least 200 x 200 pixels and must be in either JPG, PNG, or GIF format.</td>
</tr>
<tr>
<td>buttonWidth</td>
<td>Yes</td>
<td><code>58px</code></td>
<td>When the <code>displayStyle</code> is <code>button</code>, you have the option of specifying the button width.</td>
</tr>
<tr>
<td>buttonHeight</td>
<td>Yes</td>
<td><code>58px</code></td>
<td>When the <code>displayStyle</code> is <code>button</code>, you have the option of specifying the button height.</td>
</tr>
<tr>
<td>businessName</td>
<td>Yes</td>
<td>-</td>
<td>A custom business name.</td>
</tr>
<tr>
<td>businessIconUrl</td>
<td>Yes</td>
<td>-</td>
<td>A custom business icon url. The image must be at least 200 x 200 pixels and must be in either JPG, PNG, or GIF format.</td>
</tr>
<tr>
<td>backgroundImageUrl</td>
<td>Yes</td>
<td>-</td>
<td>A background image url for the conversation. Image will be tiled to fit the window.</td>
</tr>
<tr>
<td>integrationOrder</td>
<td>Yes</td>
<td>-</td>
<td>Array of integration IDs. When set, only integrations from this list will be displayed. If an empty array is used, no integrations will be displayed. <u>Note</u>: Listing an integration in the array doesn&rsquo;t guarantee that it will be displayed in the Web Messenger.</td>
</tr>
<tr>
<td>customColors</td>
<td>Yes</td>
<td><a href="#customcolors">See below.</a></td>
<td>Colors used in the Web Messenger UI.</td>
</tr>
<tr>
<td>customText</td>
<td>Yes</td>
<td>See the example below</td>
<td>Strings used in the Web Messenger UI. You can use these to either customize the text or translate it. <u>Note</u>: Some strings include variables (surrounded by <code>{}</code>) which must remain in your customized text.</td>
</tr>
<tr>
<td>menuItems</td>
<td>Yes</td>
<td><a href="#menuitems">See below.</a></td>
<td>Choose menu items.</td>
</tr>
<tr>
<td>notificationChannelPromptEnabled</td>
<td>Yes</td>
<td><code>true</code></td>
<td>Enables displaying a prompt to new users after their first message to suggest linking their chat instance with their other 3rd-party apps.</td>
</tr>
<tr>
<td>browserStorage</td>
<td>Yes</td>
<td><code>localStorage</code></td>
<td>Choose the storage type to use for storing user identity in the browser. Must be either <code>localStorage</code> or <code>sessionStorage</code>.</td>
</tr>
<tr>
<td>delegate</td>
<td>Yes</td>
<td><code>undefined</code></td>
<td>Sets a delegate on the conversation. See the <a href="#delegate">delegate</a> section for more details.</td>
</tr>
<tr>
<td>prechatCapture</td>
<td>Yes</td>
<td><a href="#prechatcapture">See below.</a></td>
<td>Enables automatically capturing a user&rsquo;s name and email via a form before the start of a conversation. Disables the chat input until the form has been submitted.</td>
</tr>
</tbody>
</table>

<h5 id="toc_11"><code>region</code></h5>

<p>AvMessagingSdk is available in the following regions:</p>

<table>
<thead>
<tr>
<th>Region</th>
<th>Region Identifier</th>
</tr>
</thead>

<tbody>
<tr>
<td>United States</td>
<td><u>Leave unspecified</u></td>
</tr>
<tr>
<td>European Union</td>
<td><code>eu-1</code></td>
</tr>
</tbody>
</table>

<h5 id="toc_12"><code>customColors</code></h5>

<table>
<thead>
<tr>
<th>Option</th>
<th>Optional?</th>
<th>Default value</th>
<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
<td>brandColor</td>
<td>Yes</td>
<td><code>65758e</code></td>
<td>This color will be used in the messenger header and the button or tab in idle state. Must be a 3 or 6-character hexadecimal color.</td>
</tr>
<tr>
<td>conversationColor</td>
<td>Yes</td>
<td><code>0099ff</code></td>
<td>This color will be used for customer messages, quick replies and actions in the footer. Must be a 3 or 6-character hexadecimal color.</td>
</tr>
<tr>
<td>actionColor</td>
<td>Yes</td>
<td><code>0099ff</code></td>
<td>This color will be used for call-to-actions inside your messages. Must be a 3 or 6-character hexadecimal color.</td>
</tr>
</tbody>
</table>

<h5 id="toc_13"><code>customText</code></h5>

<p>The list of localizable strings. These strings can be modified. <u>If an option is not given a custom string, the default value will be used.</u></p>

<table>
<thead>
<tr>
<th>Option</th>
<th>Default value</th>
</tr>
</thead>

<tbody>
<tr>
<td>actionPaymentCompleted</td>
<td>Payment Completed</td>
</tr>
<tr>
<td>actionPaymentError</td>
<td>An error occurred while processing the card. <code>&lt;br&gt;</code> Please try again or use a different card.</td>
</tr>
<tr>
<td>actionPostbackError</td>
<td>An error occurred while processing your action. Please try again.</td>
</tr>
<tr>
<td>clickToRetry</td>
<td>Message not delivered. Click to retry.</td>
</tr>
<tr>
<td>clickToRetryForm</td>
<td>Form not submitted. Click anywhere on the form to retry.</td>
</tr>
<tr>
<td>connectNotificationText</td>
<td>Give us a way to reach out:</td>
</tr>
<tr>
<td>connectNotificationSingleText</td>
<td>Be notified when you get a reply.</td>
</tr>
<tr>
<td>connectNotificationSingleButtonText</td>
<td>Turn on <code>&lt;name&gt;</code> notifications</td>
</tr>
<tr>
<td>connectNotificationOthersText</td>
<td>others</td>
</tr>
<tr>
<td>conversationTimestampHeaderFormat</td>
<td>MMMM D YYYY, h:mm A</td>
</tr>
<tr>
<td>couldNotConnect</td>
<td>Couldn&rsquo;t connect. You can {retry}.</td>
</tr>
<tr>
<td>couldNotConnectInner</td>
<td>retry connecting now</td>
</tr>
<tr>
<td>couldNotConnectWithRetry</td>
<td>Couldn&rsquo;t connect. We&rsquo;ll keep retrying, or you can {retry}.</td>
</tr>
<tr>
<td>couldNotConnectWithRetryInner</td>
<td>try now</td>
</tr>
<tr>
<td>emailChangeAddress</td>
<td>Change my email</td>
</tr>
<tr>
<td>emailDescription</td>
<td>To be notified by email when you get a reply, enter your email address.</td>
</tr>
<tr>
<td>emailFieldLabel</td>
<td>Your email</td>
</tr>
<tr>
<td>emailFieldPlaceholder</td>
<td>Your email address</td>
</tr>
<tr>
<td>emailFormButton</td>
<td>Continue</td>
</tr>
<tr>
<td>fetchHistory</td>
<td>Load more</td>
</tr>
<tr>
<td>fetchingHistory</td>
<td>Retrieving history&hellip;</td>
</tr>
<tr>
<td>fileTooLargeError</td>
<td>Max file size limit exceeded ({size})</td>
</tr>
<tr>
<td>fileTypeError</td>
<td>Unsupported file type.</td>
</tr>
<tr>
<td>formErrorInvalidEmail</td>
<td>Email is invalid</td>
</tr>
<tr>
<td>formErrorNoLongerThan</td>
<td>Must contain no more than ({characters}) characters</td>
</tr>
<tr>
<td>formErrorNoShorterThan</td>
<td>Must contain at least ({characters}) characters</td>
</tr>
<tr>
<td>formErrorUnknown</td>
<td>This doesn&rsquo;t look quite right</td>
</tr>
<tr>
<td>formFieldSelectPlaceholderFallback</td>
<td>Choose one&hellip;</td>
</tr>
<tr>
<td>frontendEmailChannelDescription</td>
<td>To talk to us using email just send a message to our email address and we\&rsquo;ll reply shortly:</td>
</tr>
<tr>
<td>headerText</td>
<td>How can we help?</td>
</tr>
<tr>
<td>imageClickToReload</td>
<td>Click to reload image.</td>
</tr>
<tr>
<td>imageClickToView</td>
<td>Click to view {size} image.</td>
</tr>
<tr>
<td>imagePreviewNotAvailable</td>
<td>Preview not available.</td>
</tr>
<tr>
<td>inputPlaceholder</td>
<td>Type a message&hellip;</td>
</tr>
<tr>
<td>inputPlaceholderBlocked</td>
<td>Complete the form above&hellip;</td>
</tr>
<tr>
<td>introAppText</td>
<td>Message us below or from your favorite app.</td>
</tr>
<tr>
<td>introductionText</td>
<td>We\&rsquo;re here to talk, so ask us anything!</td>
</tr>
<tr>
<td>lineChannelDescription</td>
<td>To talk to us using LINE, scan this QR code using the LINE app and send us a message.</td>
</tr>
<tr>
<td>linkError</td>
<td>An error occurred when attempting to generate a link for this channel. Please try again.</td>
</tr>
<tr>
<td>locationNotSupported</td>
<td>Your browser does not support location services or it’s been disabled. Please type your location instead.</td>
</tr>
<tr>
<td>locationSecurityRestriction</td>
<td>This website cannot access your location. Please type your location instead.</td>
</tr>
<tr>
<td>locationSendingFailed</td>
<td>Could not send location</td>
</tr>
<tr>
<td>locationServicesDenied</td>
<td>This website cannot access your location. Allow access in your settings or type your location instead.</td>
</tr>
<tr>
<td>messageError</td>
<td>An error occured while sending your message. Please try again.</td>
</tr>
<tr>
<td>messageIndicatorTitlePlural</td>
<td>(<code>{count}</code>) New messages</td>
</tr>
<tr>
<td>messageIndicatorTitleSingular</td>
<td>(<code>{count}</code>) New message</td>
</tr>
<tr>
<td>messageRelativeTimeDay</td>
<td><code>{value}</code>d ago</td>
</tr>
<tr>
<td>messageRelativeTimeHour</td>
<td><code>{value}</code>h ago</td>
</tr>
<tr>
<td>messageRelativeTimeJustNow</td>
<td>Just now</td>
</tr>
<tr>
<td>messageRelativeTimeMinute</td>
<td><code>{value}</code>m ago</td>
</tr>
<tr>
<td>messageTimestampFormat</td>
<td>h:mm A</td>
</tr>
<tr>
<td>messageSending</td>
<td>Sending&hellip;</td>
</tr>
<tr>
<td>messageDelivered</td>
<td>Delivered</td>
</tr>
<tr>
<td>messengerChannelDescription</td>
<td>Connect your Facebook Messenger account to be notified when you get a reply and continue the conversation on Facebook Messenger.</td>
</tr>
<tr>
<td>notificationSettingsChannelsDescription</td>
<td>You can also talk to us from your favorite app or service.</td>
</tr>
<tr>
<td>notificationSettingsChannelsTitle</td>
<td>Other Channels</td>
</tr>
<tr>
<td>notificationSettingsConnected</td>
<td>Connected</td>
</tr>
<tr>
<td>notificationSettingsConnectedAs</td>
<td>Connected as <code>{username}</code></td>
</tr>
<tr>
<td>prechatCaptureGreetingText</td>
<td>Hi there 👋\nTo start off, we\&rsquo;d like to know a little bit more about you:</td>
</tr>
<tr>
<td>prechatCaptureNameLabel</td>
<td>Your name</td>
</tr>
<tr>
<td>prechatCaptureNamePlaceholder</td>
<td>Type your name&hellip;</td>
</tr>
<tr>
<td>prechatCaptureEmailLabel</td>
<td>Email</td>
</tr>
<tr>
<td>prechatCaptureEmailPlaceholder</td>
<td><a href="mailto:name@company.com">name@company.com</a></td>
</tr>
<tr>
<td>prechatCaptureConfirmationText</td>
<td>Thanks for that! What can we help you with?</td>
</tr>
<tr>
<td>prechatCaptureMailgunLinkingConfirmation</td>
<td>You\&rsquo;ll be notified here and by email at {email} once we reply.</td>
</tr>
<tr>
<td>sendButtonText</td>
<td>Send</td>
</tr>
<tr>
<td>settingsHeaderText</td>
<td>Settings</td>
</tr>
<tr>
<td>shareLocation</td>
<td>Share location</td>
</tr>
<tr>
<td>smsBadRequestError</td>
<td>We were unable to communicate with this number. Try again or use a different one.</td>
</tr>
<tr>
<td>smsCancel</td>
<td>Cancel</td>
</tr>
<tr>
<td>smsChangeNumber</td>
<td>Change my number</td>
</tr>
<tr>
<td>smsChannelDescription</td>
<td>Connect your SMS number to be notified when you get a reply and continue the conversation over SMS.</td>
</tr>
<tr>
<td>smsChannelPendingDescription</td>
<td>Check your messages at <code>{number}</code> to confirm your phone number.</td>
</tr>
<tr>
<td>smsContinue</td>
<td>Continue</td>
</tr>
<tr>
<td>smsInvalidNumberError</td>
<td>Your phone number isn\&rsquo;t valid. Please try again.</td>
</tr>
<tr>
<td>smsLinkCancelled</td>
<td>Link to <code>{appUserNumber}</code> was cancelled.</td>
</tr>
<tr>
<td>smsLinkPending</td>
<td>Pending</td>
</tr>
<tr>
<td>smsPingChannelError</td>
<td>There was an error sending a message to your number.</td>
</tr>
<tr>
<td>smsSendText</td>
<td>Send me a text</td>
</tr>
<tr>
<td>smsStartTexting</td>
<td>Start Texting</td>
</tr>
<tr>
<td>smsTooManyRequestsError</td>
<td>A connection for that number was requested recently. Please try again in {minutes} minutes.</td>
</tr>
<tr>
<td>smsTooManyRequestsOneMinuteError</td>
<td>A connection for that number was requested recently. Please try again in 1 minute.</td>
</tr>
<tr>
<td>smsUnhandledError</td>
<td>Something went wrong. Please try again.</td>
</tr>
<tr>
<td>tapToRetry</td>
<td>Message not delivered. Tap to retry.</td>
</tr>
<tr>
<td>tapToRetryForm</td>
<td>Form not submitted. Tap anywhere on the form to retry.</td>
</tr>
<tr>
<td>telegramChannelDescription</td>
<td>Connect your Telegram account to be notified when you get a reply and continue the conversation on Telegram</td>
</tr>
<tr>
<td>uploadDocument</td>
<td>Upload document</td>
</tr>
<tr>
<td>uploadInvalidError</td>
<td>Invalid file</td>
</tr>
<tr>
<td>uploadPhoto</td>
<td>Upload photo</td>
</tr>
<tr>
<td>uploadVirusError</td>
<td>A virus was detected in your file and it has been rejected</td>
</tr>
<tr>
<td>unsupportedMessageType</td>
<td>Unsupported message type.</td>
</tr>
<tr>
<td>unsupportedActionType</td>
<td>Unsupported action type.</td>
</tr>
<tr>
<td>viberChannelDescription</td>
<td>Connect your Viber account to be notified when you get a reply and continue the conversation on Viber. To get started, scan the QR code using the Viber app.</td>
</tr>
<tr>
<td>viberChannelDescriptionMobile</td>
<td>Connect your Viber account to be notified when you get a reply and continue the conversation on Viber. To get started, install the Viber app and tap Connect.</td>
</tr>
<tr>
<td>viberQRCodeError</td>
<td>An error occurred while fetching your Viber QR code. Please try again.</td>
</tr>
<tr>
<td>wechatChannelDescription</td>
<td>Connect your WeChat account to be notified when you get a reply and continue the conversation on WeChat. To get started, scan this QR code using the WeChat app.</td>
</tr>
<tr>
<td>wechatChannelDescriptionMobile</td>
<td>Connect your WeChat account to be notified when you get a reply and continue the conversation on WeChat. To get started, save this QR code image and upload it <code>&lt;a href=\&#39;weixin://dl/scan\&#39;&gt;</code>QR code scanner<code>&lt;/a&gt;</code>.</td>
</tr>
<tr>
<td>wechatQRCodeError</td>
<td>An error occurred while fetching your WeChat QR code. Please try again.</td>
</tr>
<tr>
<td>whatsappChannelDescriptionDesktop</td>
<td>Sync your account to WhatsApp by scanning the QR code or clicking the link below.\nThen, send the pre-populated message to validate the sync request. (Your code: {{code}}).</td>
</tr>
<tr>
<td>whatsappChannelDescriptionMobile</td>
<td>Sync your account to WhatsApp by clicking the link below.\nThen, send the pre-populated message to validate the sync request. (Your code: {{code}}).</td>
</tr>
<tr>
<td>whatsappLinkingError</td>
<td>An error occurred while fetching your WhatsApp linking information. Please try again.</td>
</tr>
</tbody>
</table>

<p><a href="#example">See below</a> for an example.</p>

<h5 id="toc_14"><code>menuItems</code></h5>

<table>
<thead>
<tr>
<th>Option</th>
<th>Optional?</th>
<th>Default value</th>
<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
<td>imageUpload</td>
<td>Yes</td>
<td><code>true</code></td>
<td>Enables the image upload menu item.</td>
</tr>
<tr>
<td>fileUpload</td>
<td>Yes</td>
<td><code>true</code></td>
<td>Enables the file upload menu item.</td>
</tr>
<tr>
<td>shareLocation</td>
<td>Yes</td>
<td><code>true</code></td>
<td>Enables the share location menu item.</td>
</tr>
</tbody>
</table>

<p><a href="#example">See below</a> for an example.</p>

<h5 id="toc_15"><code>prechatCapture</code></h5>

<table>
<thead>
<tr>
<th>Option</th>
<th>Optional?</th>
<th>Default value</th>
<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
<td>enabled</td>
<td>Yes</td>
<td><code>false</code></td>
<td>Enables the prechat capture experience.</td>
</tr>
<tr>
<td>enableEmailLinking</td>
<td>Yes</td>
<td><code>true</code></td>
<td>Automatically links the user&rsquo;s email to the app&rsquo;s Mailgun integration if it exists. If the property <code>fields</code> is defined, the first field of type <code>email</code> will be used.</td>
</tr>
<tr>
<td>fields</td>
<td>Yes</td>
<td>-</td>
<td>Overrides the default Prechat Capture fields to define a custom form.</td>
</tr>
</tbody>
</table>

<p><a href="#example">See below</a> for an example.</p>

<p><code>prechatCapture</code> uses the following <a href="#customText"><code>customText</code></a> options:</p>

<table>
<thead>
<tr>
<th>Option</th>
<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
<td>prechatCaptureGreetingText</td>
<td>Text for the initial greeting message.</td>
</tr>
<tr>
<td>prechatCaptureNameLabel</td>
<td>Label displayed for the default form&rsquo;s first field.</td>
</tr>
<tr>
<td>prechatCaptureNamePlaceholder</td>
<td>Placeholder for the default form&rsquo;s first field.</td>
</tr>
<tr>
<td>prechatCaptureEmailLabel</td>
<td>Label displayed for the default form&rsquo;s second field.</td>
</tr>
<tr>
<td>prechatCaptureEmailPlaceholder</td>
<td>Placeholder for the default form&rsquo;s second field.</td>
</tr>
<tr>
<td>prechatCaptureConfirmationText</td>
<td>Text for the confirmation message sent when the form is completed.</td>
</tr>
<tr>
<td>prechatCaptureMailgunLinkingConfirmation</td>
<td>Text for the notification message when a user has linked their email address.</td>
</tr>
</tbody>
</table>

<h5 id="toc_16">Example</h5>

<div><pre><code class="language-javascript">var initPromise = AvMessagingSdk.init({
    integrationId: &#39;&lt;integration-id&gt;&#39;,

    // Leave unspecified for US region (default)
    region: &#39;eu-1&#39;,

    // For authenticated mode
    jwt: &#39;your_jwt&#39;,
    userId: &#39;user_id&#39;,
    locale: &#39;en-US&#39;,

    customColors: {
        brandColor: &#39;65758e&#39;,
        conversationColor: &#39;65758e&#39;,
        actionColor: &#39;65758e&#39;,
    },

    menuItems: {
        imageUpload: true,
        fileUpload: true,
        shareLocation: true
    },

    fixedIntroPane: false,

    prechatCapture: {
        enabled: true,
        enableEmailLinking: true,
        fields: [
            {
                type: &#39;email&#39;,
                name: &#39;email&#39;,
                label: &#39;Email&#39;,
                placeholder: &#39;your@email.com&#39;
            },
            {
                type: &#39;text&#39;,
                name: &#39;company-website&#39;,
                label: &#39;Company website&#39;,
                placeholder: &#39;mycompany.com&#39;
            },
            {
                type: &#39;select&#39;,
                name: &#39;company-size&#39;,
                label: &#39;Company size&#39;,
                placeholder: &#39;Choose a number...&#39;,
                options: [
                    {
                        name: &#39;1-10&#39;,
                        label: &#39;1-10 employees&#39;
                    },
                    {
                        name: &#39;11-50&#39;,
                        label: &#39;11-50 employees&#39;
                    },
                    {
                        name: &#39;51+&#39;,
                        label: &#39;51+ employees&#39;
                    }
                ]
            }
        ]
    },

    customText: {
        actionPaymentCompleted: &#39;Payment Completed&#39;,
        actionPaymentError: &#39;An error occurred while processing the card. &lt;br&gt; Please try again or use a different card.&#39;,
        actionPostbackError: &#39;An error occurred while processing your action. Please try again.&#39;,
        clickToRetry: &#39;Message not delivered. Click to retry.&#39;,
        clickToRetryForm: &#39;Form not submitted. Click anywhere on the form to retry.&#39;,
        connectNotificationText: &#39;Give us a way to reach out:&#39;,
        connectNotificationSingleText: &#39;Be notified when you get a reply.&#39;,
        connectNotificationSingleButtonText: &#39;Turn on &lt;name&gt; notifications&#39;,
        connectNotificationOthersText: &#39;others&#39;,
        conversationTimestampHeaderFormat: &#39;MMMM D YYYY, h:mm A&#39;,
        couldNotConnect: &#39;Couldn\&#39;t connect. You can {retry}. &#39;
        couldNotConnectInner: &#39;retry connecting now&#39;
        couldNotConnectWithRetry: &#39;Couldn\&#39;t connect. We\&#39;ll keep retrying, or you can {retry}.&#39;,
        couldNotConnectWithRetryInner: &#39;try now&#39;,
        emailChangeAddress: &#39;Change my email&#39;,
        emailDescription: &#39;To be notified by email when you get a reply, enter your email address.&#39;,
        emailFieldLabel: &#39;Your email&#39;,
        emailFieldPlaceholder: &#39;Your email address&#39;,
        emailFormButton: &#39;Continue&#39;,
        fetchHistory: &#39;Load more&#39;,
        fetchingHistory: &#39;Retrieving history...&#39;,
        fileTooLargeError: &#39;Max file size limit exceeded ({size})&#39;,
        fileTypeError: &#39;Unsupported file type.&#39;,
        formErrorInvalidEmail: &#39;Email is invalid&#39;,
        formErrorNoLongerThan: &#39;Must contain no more than ({characters}) characters&#39;,
        formErrorNoShorterThan: &#39;Must contain at least ({characters}) characters&#39;,
        formErrorUnknown: &#39;This doesn\&#39;t look quite right&#39;,
        formFieldSelectPlaceholderFallback: &#39;Choose one...&#39;,
        frontendEmailChannelDescription: &#39;To talk to us using email just send a message to our email address and we\&#39;ll reply shortly:&#39;,
        headerText: &#39;How can we help?&#39;,
        imageClickToReload: &#39;Click to reload image.&#39;,
        imageClickToView: &#39;Click to view {size} image.&#39;,
        imagePreviewNotAvailable: &#39;Preview not available.&#39;,
        inputPlaceholder: &#39;Type a message...&#39;,
        inputPlaceholderBlocked: &#39;Complete the form above...&#39;,
        introAppText: &#39;Message us below or from your favorite app.&#39;,
        introductionText: &#39;We\&#39;re here to talk, so ask us anything!&#39;,
        lineChannelDescription: &#39;To talk to us using LINE, scan this QR code using the LINE app and send us a message.&#39;,
        linkError: &#39;An error occurred when attempting to generate a link for this channel. Please try again.&#39;,
        locationNotSupported: &#39;Your browser does not support location services or it’s been disabled. Please type your location instead.&#39;,
        locationSecurityRestriction: &#39;This website cannot access your location. Please type your location instead.&#39;,
        locationSendingFailed: &#39;Could not send location&#39;,
        locationServicesDenied: &#39;This website cannot access your location. Allow access in your settings or type your location instead.&#39;,
        messageError: &#39;An error occured while sending your message. Please try again.&#39;,
        messageIndicatorTitlePlural: &#39;({count}) New messages&#39;,
        messageIndicatorTitleSingular: &#39;({count}) New message&#39;,
        messageRelativeTimeDay: &#39;{value}d ago&#39;,
        messageRelativeTimeHour: &#39;{value}h ago&#39;,
        messageRelativeTimeJustNow: &#39;Just now&#39;,
        messageRelativeTimeMinute: &#39;{value}m ago&#39;,
        messageTimestampFormat: &#39;h:mm A&#39;,
        messageSending: &#39;Sending...&#39;,
        messageDelivered: &#39;Delivered&#39;,
        messengerChannelDescription: &#39;Connect your Facebook Messenger account to be notified when you get a reply and continue the conversation on Facebook Messenger.&#39;,
        notificationSettingsChannelsDescription: &#39;You can also talk to us from your favorite app or service.&#39;,
        notificationSettingsChannelsTitle: &#39;Other Channels&#39;,
        notificationSettingsConnected: &#39;Connected&#39;,
        notificationSettingsConnectedAs: &#39;Connected as {username}&#39;,
        prechatCaptureGreetingText: &#39;Hi there 👋\nTo start off, we\&#39;d like to know a little bit more about you:&#39;,
        prechatCaptureNameLabel: &#39;Your name&#39;,
        prechatCaptureNamePlaceholder: &#39;Type your name...&#39;,
        prechatCaptureEmailLabel: &#39;Email&#39;,
        prechatCaptureEmailPlaceholder: &#39;name@company.com&#39;,
        prechatCaptureConfirmationText: &#39;Thanks for that! What can we help you with?&#39;,
        prechatCaptureMailgunLinkingConfirmation: &#39;You\&#39;ll be notified here and by email at {email} once we reply.&#39;,
        sendButtonText: &#39;Send&#39;,
        settingsHeaderText: &#39;Settings&#39;,
        shareLocation: &#39;Share location&#39;,
        smsBadRequestError: &#39;We were unable to communicate with this number. Try again or use a different one.&#39;,
        smsCancel: &#39;Cancel&#39;,
        smsChangeNumber: &#39;Change my number&#39;,
        smsChannelDescription: &#39;Connect your SMS number to be notified when you get a reply and continue the conversation over SMS.&#39;,
        smsChannelPendingDescription: &#39;Check your messages at {number} to confirm your phone number.&#39;,
        smsContinue: &#39;Continue&#39;,
        smsInvalidNumberError: &#39;Your phone number isn\&#39;t valid. Please try again.&#39;,
        smsLinkCancelled: &#39;Link to {appUserNumber} was cancelled.&#39;,
        smsLinkPending: &#39;Pending&#39;,
        smsPingChannelError: &#39;There was an error sending a message to your number.&#39;,
        smsSendText: &#39;Send me a text&#39;,
        smsStartTexting: &#39;Start Texting&#39;,
        smsTooManyRequestsError: &#39;A connection for that number was requested recently. Please try again in {minutes} minutes.&#39;,
        smsTooManyRequestsOneMinuteError: &#39;A connection for that number was requested recently. Please try again in 1 minute.&#39;,
        smsUnhandledError: &#39;Something went wrong. Please try again.&#39;,
        tapToRetry: &#39;Message not delivered. Tap to retry.&#39;,
        tapToRetryForm: &#39;Form not submitted. Tap anywhere on the form to retry.&#39;,
        telegramChannelDescription: &#39;Connect your Telegram account to be notified when you get a reply and continue the conversation on Telegram&#39;,
        uploadDocument: &#39;Upload document&#39;,
        uploadInvalidError: &#39;Invalid file&#39;,
        uploadPhoto: &#39;Upload photo&#39;,
        uploadVirusError: &#39;A virus was detected in your file and it has been rejected&#39;,
        unsupportedMessageType: &#39;Unsupported message type.&#39;,
        unsupportedActionType: &#39;Unsupported action type.&#39;,
        viberChannelDescription: &#39;Connect your Viber account to be notified when you get a reply and continue the conversation on Viber. To get started, scan the QR code using the Viber app.&#39;,
        viberChannelDescriptionMobile: &#39;Connect your Viber account to be notified when you get a reply and continue the conversation on Viber. To get started, install the Viber app and tap Connect.&#39;,
        viberQRCodeError: &#39;An error occurred while fetching your Viber QR code. Please try again.&#39;,
        wechatChannelDescription: &#39;Connect your WeChat account to be notified when you get a reply and continue the conversation on WeChat. To get started, scan this QR code using the WeChat app.&#39;,
        wechatChannelDescriptionMobile: &#39;Connect your WeChat account to be notified when you get a reply and continue the conversation on WeChat. To get started, save this QR code image and upload it in the &lt;a href=\&#39;weixin://dl/scan\&#39;&gt;QR code scanner&lt;/a&gt;.&#39;,
        wechatQRCodeError: &#39;An error occurred while fetching your WeChat QR code. Please try again.&#39;,
        whatsappChannelDescriptionDesktop: &#39;Sync your account to WhatsApp by scanning the QR code or clicking the link below.\nThen, send the pre-populated message to validate the sync request. (Your code: {{code}}).&#39;,
        whatsappChannelDescriptionMobile: &#39;Sync your account to WhatsApp by clicking the link below.\nThen, send the pre-populated message to validate the sync request. (Your code: {{code}}).&#39;,
        whatsappLinkingError: &#39;An error occurred while fetching your WhatsApp linking information. Please try again.&#39;
    }
}).then(function() {
    // Your code after init is complete
});

initPromise.then(function() {
    // do something
});

// pass it around...

initPromise.then(function() {
    //do something else
});
</code></pre></div>

<h4 id="toc_17">open()</h4>

<p>Opens the conversation widget (noop when embedded)</p>

<div><pre><code class="language-javascript">AvMessagingSdk.open();</code></pre></div>

<h4 id="toc_18">close()</h4>

<p>Closes the conversation widget (noop when embedded)</p>

<div><pre><code class="language-javascript">AvMessagingSdk.close();</code></pre></div>

<h4 id="toc_19">isOpened()</h4>

<p>Tells if the widget is currently opened or closed.</p>

<div><pre><code class="language-javascript">AvMessagingSdk.isOpened();</code></pre></div>

<h4 id="toc_20">login(userId , jwt)</h4>

<p>Logs a user in the Web Messenger, retrieving the conversation the user already had on other browsers and/or devices. Note that you don&rsquo;t need to call this after <code>init</code> if you passed the user id and jwt already, it&rsquo;s done internally. This returns a promise that resolves when the Web Messenger is ready again.</p>

<div><pre><code class="language-javascript">AvMessagingSdk.login(&#39;some-id&#39;, &#39;some-jwt&#39;);</code></pre></div>

<h4 id="toc_21">logout()</h4>

<p>Logs out the current user and reinitialize the widget with an anonymous user. This returns a promise that resolves when the Web Messenger is ready again.</p>

<div><pre><code class="language-javascript">AvMessagingSdk.logout();</code></pre></div>

<h4 id="toc_22">destroy()</h4>

<p>Destroys the Web Messenger and makes it disappear. The Web Messenger has to be reinitialized with <code>init</code> to be working again because it also clears up the integration id from the Web Messenger. It will also unbind all listeners you might have with <code>AvMessagingSdk.on</code>.</p>

<div><pre><code class="language-javascript">AvMessagingSdk.destroy();</code></pre></div>

<h4 id="toc_23">sendMessage(message)</h4>

<p>Sends a message on the user&rsquo;s behalf</p>

<div><pre><code class="language-javascript">AvMessagingSdk.sendMessage({
    type: &#39;text&#39;,
    text: &#39;hello&#39;
});

// OR

AvMessagingSdk.sendMessage(&#39;hello&#39;, &#39;&lt;conversation-id&gt;&#39;);</code></pre></div>

<h4 id="toc_24">startTyping()</h4>

<p>Sends an event indicating the appUser has started typing. When called, a <code>stopTyping</code> timer will be created and will call <code>stopTyping()</code> after 10s, unless <code>stopTyping()</code> has been called manually. Everytime <code>startTyping()</code> is called the timer is reset. If <code>startTyping()</code> is called repeatedly, an event will only be sent if the time since the last sent event is greater then 10s.</p>

<p>If <strong>conversationId</strong> is not provided, the currently loaded conversation will be used.</p>

<div><pre><code class="language-javascript">AvMessagingSdk.startTyping();</code></pre></div>

<h4 id="toc_25">stopTyping()</h4>

<p>Sends an event indicating the appUser has stoped typing.</p>

<div><pre><code class="language-javascript">AvMessagingSdk.stopTyping();</code></pre></div>

<h4 id="toc_26">triggerPostback(actionId, conversationId)</h4>

<p>Trigger a <code>postback</code> action on the user&rsquo;s behalf.
The <code>actionId</code> is the <code>_id</code> property of the targeted action.</p>

<p>If you have the <code>_id</code> of the targetted <code>postback</code> action, you can pass it directly to <code>triggerPostback</code>.</p>

<p>If <strong>conversationId</strong> is not provided, the currently loaded conversation will be used.</p>

<div><pre><code class="language-javascript">const actionId = &#39;5a747faa065bbe4e7804f2a4&#39;;
AvMessagingSdk.triggerPostback(actionId, &#39;62565b5c2b4039adff80b7fd&#39;);</code></pre></div>

<p>Otherwise, you can get the <code>_id</code> of an action by using <code>AvMessagingSdk.getConversation()</code>, e.g.</p>

<div><pre><code class="language-javascript">const conversation = AvMessagingSdk.getConversation();

console.log(conversation.messages);
// [
//     {
//         &quot;text&quot;: &quot;Do you want to continue?&quot;,
//         &quot;actions&quot;: [
//             {
//                 &quot;payload&quot;: &quot;text:continue&quot;,
//                 &quot;text&quot;: &quot;Continue conversation&quot;,
//                 &quot;_id&quot;: &quot;5a7c65211aaa9b61f69c95e3&quot;,
//                 &quot;type&quot;: &quot;postback&quot;
//             }
//         ],
//         &quot;type&quot;: &quot;text&quot;,
//         &quot;role&quot;: &quot;appMaker&quot;,
//         &quot;_id&quot;: &quot;5a7c65211aaa9b61f69c95e2&quot;,
//         // ...
//     }
// ]

// Indicate that the user has clicked on the &quot;Continue conversation&quot; postback action.
AvMessagingSdk.triggerPostback(conversation.messages[0].actions[0]._id);</code></pre></div>

<h4 id="toc_27">updateUser(user)</h4>

<p>Updates user information</p>

<div><pre><code class="language-javascript">AvMessagingSdk.updateUser({
    givenName: &#39;Updated&#39;,
    surname: &#39;Name&#39;,
    email: &#39;updated@email.com&#39;,
    properties: {
      &#39;justGotUpdated&#39;: true
    }
});</code></pre></div>

<h4 id="toc_28">getUser()</h4>

<p>Returns the current user.</p>

<div><pre><code class="language-javascript">var user = AvMessagingSdk.getUser()</code></pre></div>

<h4 id="toc_29">getConversation()</h4>

<p>Returns the conversation if it exists</p>

<div><pre><code class="language-javascript">var conversation = AvMessagingSdk.getConversation();

// Data object
conversation = {
    _id: &#39;&lt;conversation-id&gt;&#39;,
    unreadCount: 0,
    lastUpdatedAt: 1581010017.596,
    type: &quot;personal&quot;,
    participants: [
        {
            _id: &#39;&lt;participant-id&gt;&#39;,
            appUserId: &#39;&lt;appUser-id&gt;&#39;,
            unreadCount: 0,
            lastRead: 1581010017.596
        }
    ],
    metadata: {},
    messages: [
        {
            role: &#39;appUser&#39;,
            authorId: &#39;6ac41c8b32e704f3cdb9052d&#39;,
            name: &#39;Some user&#39;,
            _id: &#39;5e6022c9cb55158bfd53f845&#39;,
            type: &quot;text&quot;,
            received: 1583358665.139,
            text: &#39;Hello&#39;,
            source: {
                type: &#39;web&#39;,
                id: &#39;c38ae913af7c4ef3800b339ee529c579&#39;,
                integrationId: &#39;5d8274d4aa780a5483f0ee56&#39;
            }
        }
    ]
}</code></pre></div>

<h4 id="toc_30">loadConversation(conversationId)</h4>

<p>Loads a conversation into the current session</p>

<div><pre><code class="language-javascript">AvMessagingSdk.loadConversation(&#39;&lt;conversation-id&gt;&#39;);</code></pre></div>

<h4 id="toc_31">startConversation()</h4>

<p>Creates a user and conversation on the server, allowing the business to reach out proactively to the user via the public API.</p>

<p>It is strongly recommended to only call this method in the case where a message is likely to be sent.</p>

<p>This method is called automatically when starting a conversation via the <code>sendMessage</code> method, or when a user sends a message via the conversation view.</p>

<p>If a conversation already exists for the current user, this call is a no-op.</p>

<div><pre><code class="language-javascript">AvMessagingSdk.startConversation();</code></pre></div>

<h4 id="toc_32">markAllAsRead()</h4>

<p>Marks all unread messages as read.</p>

<div><pre><code class="language-javascript">AvMessagingSdk.markAllAsRead();</code></pre></div>

<h4 id="toc_33">showNotificationChannelPrompt()</h4>

<p>Displays a prompt to the user suggesting the linking of the current chat instance with other 3rd-party apps.</p>

<div><pre><code class="language-javascript">AvMessagingSdk.showNotificationChannelPrompt();</code></pre></div>

<h4 id="toc_34">setPredefinedMessage(message)</h4>

<p>Prefills the user&rsquo;s chat input with a predefined message.</p>

<div><pre><code class="language-javascript">AvMessagingSdk.setPredefinedMessage(message);</code></pre></div>

<h4 id="toc_35">setDelegate(delegate)</h4>

<p>Sets a delegate on the conversation. AvMessagingSdk must be initialized before calling this method. See the <a href="#delegate">delegate</a> section for more details.</p>

<div><pre><code class="language-javascript">AvMessagingSdk.setDelegate(delegate);</code></pre></div>

<h3 id="toc_36">Delegate</h3>

<p>AvMessagingSdk allows you to set a delegate to receive callbacks when important changes happen in the conversation.
To set a delegate, pass the <code>delegate</code> parameter in to <a href="#options">init options</a>, or use the <a href="#setdelegatedelegate">setDelegate</a> method. The <code>delegate</code> object may optionally contain <code>beforeDisplay</code>, <code>beforeSend</code>, <code>beforePostbackSend</code> and <code>onInvalidAuth</code> delegate functions.</p>

<p>A <code>data</code> object is passed down with all the delegate events except <code>onInvalidAuth</code>. This is a read-only object containing a truncated version of the conversation associated with the event.</p>

<div><pre><code class="language-javascript">const delegate = {
    beforeDisplay(message, data) {
        if (data.conversation._id === &#39;&lt;my-conversation-id&gt;&#39;) {
            message.name = &#39;Acme Blank&#39;;
        }

        return message;
    },
    beforeSend(message, data) {
        return message;
    },
    beforePostbackSend(postback, data) {
        return postback;
    },
    onInvalidAuth() {
        return new Promise((resolve) =&gt;
            resolve(&#39;&lt;my-new-auth-token&gt;&#39;)
        )
    }
}

// Passing delegate as an init parameter
AvMessagingSdk.init({
    integrationId: &#39;&lt;integration-id&gt;&#39;,
    delegate
});

// Using setDelegate
AvMessagingSdk.init({ integrationId: &#39;&lt;integration-id&gt;&#39; }).then(() =&gt; {
    AvMessagingSdk.setDelegate(delegate);
});</code></pre></div>

<h4 id="toc_37">beforeDisplay</h4>

<p>The <code>beforeDisplay</code> delegate allows a message to be hidden or modified before it is displayed in the conversation. This delegate should return a falsy value such as <code>null</code> to hide the message. It can also return a modified message object in order to change what the user will see rendered in their conversation history. Note that this change affects the client side rendering only; the server side copy of this message can not be modified by this delegate.</p>

<div><pre><code class="language-javascript">AvMessagingSdk.init({
    integrationId: &#39;&lt;integration-id&gt;&#39;,
    delegate: {
        beforeDisplay(message, data) {
            if (data.conversation._id === &#39;&lt;conversation-id&gt;&#39; &amp;&amp; message.metadata &amp;&amp; message.metadata.isHidden) {
                return null;
            }

            return message;
        }
    }
});</code></pre></div>

<h4 id="toc_38">beforeSend</h4>

<p>The <code>beforeSend</code> delegate method allows you to modify properties of a message before sending it to AvMessagingSdk.
The modified message must be returned for it to take effect.</p>

<p>Note that when a file or an image is uploaded, only the message <code>metadata</code> may be updated. Other message properties such as <code>type</code> or <code>text</code> won&rsquo;t be considered.</p>

<div><pre><code class="language-javascript">AvMessagingSdk.init({
    integrationId: &#39;&lt;integration-id&gt;&#39;
    delegate: {
        beforeSend(message, data) {
            if (data.conversation._id === &#39;&lt;conversation-id&gt;&#39;) {
                message.metadata = {
                    any: &#39;info&#39;
                };
            }

            return message;
        }
    }
});</code></pre></div>

<h4 id="toc_39">beforePostbackSend</h4>

<p>The <code>beforePostbackSend</code> delegate method allows you to modify properties of a postback before sending it to AvMessagingSdk.
The modified postback must be returned for it to take effect.</p>

<div><pre><code class="language-javascript">AvMessagingSdk.init({
   integrationId: &#39;&lt;integration-id&gt;&#39;,
   delegate: {
       beforePostbackSend(postback) {
           if (data.conversation._id === &#39;&lt;conversation-id&gt;&#39;) {
               postback.metadata = {
                   any: &#39;info&#39;
               };
           }

           return postback;
       }
   }
});</code></pre></div>

<h4 id="toc_40">onInvalidAuth</h4>

<p>The <code>onInvalidAuth</code> delegate notifies the delegate of a failed request due to invalid credentials and allows the implementer to set a new auth token in order to retry the request. The delegate must return a new JWT token as a <code>string</code> or <code>Promise&lt;string&gt;</code> that will resolve into the JWT.</p>

<div><pre><code class="language-javascript">AvMessagingSdk.init({
    integrationId: &#39;&lt;integration-id&gt;&#39;,
    delegate: {
        onInvalidAuth() {
            return &#39;&lt;my-new-auth-token&gt;&#39;;
        }
    }
});</code></pre></div>

<h3 id="toc_41">Events</h3>

<p>If you want to make sure your events are triggered, try to bind them before calling <code>AvMessagingSdk.init</code>.</p>

<p>To bind an event, use <code>AvMessagingSdk.on(&lt;event name&gt;, &lt;handler&gt;);</code>. To unbind events, you can either call <code>AvMessagingSdk.off(&lt;event name&gt;, handler)</code> to remove one specific handler, call <code>AvMessagingSdk.off(&lt;event name&gt;)</code> to remove all handlers for an event, or call <code>AvMessagingSdk.off()</code> to unbind all handlers.</p>

<h4 id="toc_42">ready</h4>

<div><pre><code class="language-javascript">// This event triggers when init completes successfully... Be sure to bind before calling init!
AvMessagingSdk.on(&#39;ready&#39;, function(){
    console.log(&#39;the init has completed!&#39;);
});

AvMessagingSdk.init(...).then(function() {
    // Your code after init is complete
});</code></pre></div>

<h4 id="toc_43">destroy</h4>

<div><pre><code class="language-javascript">// This event triggers when the widget is destroyed.
AvMessagingSdk.on(&#39;destroy&#39;, function(){
    console.log(&#39;the widget is destroyed!&#39;);
});

AvMessagingSdk.destroy();</code></pre></div>

<h4 id="toc_44">participant:added</h4>

<div><pre><code class="language-javascript">// This event triggers when a participant is added to a conversation
AvMessagingSdk.on(&#39;participant:added&#39;, function(participant, data) {
    console.log(`A participant was added to conversation ${data.conversation._id}: `, participant);
});</code></pre></div>

<h4 id="toc_45">participant:removed</h4>

<div><pre><code class="language-javascript">// This event triggers when a participant is removed from a conversation
AvMessagingSdk.on(&#39;participant:removed&#39;, function(participant, data) {
    console.log(`A participant was removed from conversation ${data.conversation._id}: `, participant);
});</code></pre></div>

<h4 id="toc_46">conversation:added</h4>

<div><pre><code class="language-javascript">// This event triggers when a conversation is added
AvMessagingSdk.on(&#39;conversation:added&#39;, function(participants, data) {
    console.log(`Conversation ${data.conversation._id} was added with following participants: `, participants);
});</code></pre></div>

<h4 id="toc_47">conversation:read</h4>

<div><pre><code class="language-javascript">// This event triggers when a participant in a sdkGroup chat reads a message
AvMessagingSdk.on(&#39;conversation:read&#39;, function(payload, data) {
    if (data.role === &#39;appMaker&#39;) {
        console.log(`Conversation ${data.conversation._id} was read by appMaker`);
    } else if (data.role === &#39;appUser&#39;) {
        console.log(`Conversation ${data.conversation._id} was read by appUserId: ${payload.appUserId}`);
    }
});

// Data object, if the conversation was read by the appMaker, the appUser property will not exist
payload = {
    appUserId: &#39;&lt;appUser-id&gt;&#39;,
    lastRead: 1581010017.596,
    role: &#39;appUser&#39;
}

data = {
    conversation: {
        _id: &#39;&lt;conversation-id&gt;&#39;
    }
}</code></pre></div>

<h4 id="toc_48">conversation:removed</h4>

<div><pre><code class="language-javascript">// This event triggers when a conversation is removed
AvMessagingSdk.on(&#39;conversation:removed&#39;, function(data) {
    console.log(`Conversation ${data.conversation._id} was removed`);
});

// data object
data = {
    conversation: {
        _id: &#39;&lt;conversation-id&gt;&#39;
    }
}</code></pre></div>

<h4 id="toc_49">message:received</h4>

<div><pre><code class="language-javascript">// This event triggers when the user receives a message
AvMessagingSdk.on(&#39;message:received&#39;, function(message, data) {
    console.log(`The user received a message in conversation ${data.conversation._id}: `, message);
});

// data object
data = {
    conversation: {
        _id: &#39;&lt;conversation-id&gt;&#39;
    }
}</code></pre></div>

<h4 id="toc_50">message:sent</h4>

<div><pre><code class="language-javascript">// This event triggers when the user sends a message
AvMessagingSdk.on(&#39;message:sent&#39;, function(message, data) {
    console.log(`The user sent a message in conversation ${data.conversation._id}: `, message);
});

// data object
data = {
    conversation: {
        _id: &#39;&lt;conversation-id&gt;&#39;
    }
}</code></pre></div>

<h4 id="toc_51">message</h4>

<div><pre><code class="language-javascript">// This event triggers when a message was added to the conversation
AvMessagingSdk.on(&#39;message&#39;, function(message, data) {
    console.log(`A message was added in the conversation ${data.conversation._id}: `, message);
});

// data object
data = {
    conversation: {
        _id: &#39;&lt;conversation-id&gt;&#39;
    }
}</code></pre></div>

<h4 id="toc_52">unreadCount</h4>

<div><pre><code class="language-javascript">// This event triggers when the number of unread messages changes
AvMessagingSdk.on(&#39;unreadCount&#39;, function(unreadCount, data) {
    console.log(`the number of unread messages was updated for conversation ${data.conversation._id}:`, unreadCount);
});

// data object
data = {
    conversation: {
        _id: &#39;&lt;conversation-id&gt;&#39;
    }
}</code></pre></div>

<h4 id="toc_53">widget:opened</h4>

<div><pre><code class="language-javascript">// This event triggers when the widget is opened
AvMessagingSdk.on(&#39;widget:opened&#39;, function() {
    console.log(&#39;Widget is opened!&#39;);
});</code></pre></div>

<h4 id="toc_54">widget:closed</h4>

<div><pre><code class="language-javascript">// This event triggers when the widget is closed
AvMessagingSdk.on(&#39;widget:closed&#39;, function() {
    console.log(&#39;Widget is closed!&#39;);
});</code></pre></div>

<h4 id="toc_55">connected</h4>

<div><pre><code class="language-javascript">// This event triggers when an active connection has been established for the first time,
// or when the connection has been re-established after a `disconnect` event.
AvMessagingSdk.on(&#39;connected&#39;, function(e) {
    console.log(&#39;Connected&#39;);
});</code></pre></div>

<h4 id="toc_56">disconnected</h4>

<div><pre><code class="language-javascript">// This event triggers when an active connection is lost
// While disconnected, the client will not be able to recieve messages
AvMessagingSdk.on(&#39;disconnected&#39;, function(e) {
    console.log(&#39;Disonnected&#39;);
});</code></pre></div>

<h4 id="toc_57">typing:start</h4>

<div><pre><code class="language-javascript">// This event triggers when appMaker starts typing. The associated conversation is passed in the argument.
AvMessagingSdk.on(&#39;typing:start&#39;, function(data) {
    console.log(`${data.name} started typing!`, data.conversation._id);
});

// If the name and avatarUrl for the typing user is known it will be available as properties in the data object

// Data object
data = {
    conversation: {
        _id: &#39;&lt;conversation-id&gt;&#39;,
    },
    avatarUrl: &#39;http://path.com/to/avatar-url-of-user&#39;,
    name: &#39;Name of Typing User&#39;,
}</code></pre></div>

<h4 id="toc_58">typing:stop</h4>

<div><pre><code class="language-javascript">// This event triggers when appMaker stops typing. The associated conversation is passed in the argument.
AvMessagingSdk.on(&#39;typing:stop&#39;, function(data) {
    console.log(`${data.name} stopped typing!`, data.conversation._id);
});

// data object
data = {
    conversation: {
        _id: &#39;&lt;conversation-id&gt;&#39;
    }
}</code></pre></div>

<h3 id="toc_59">Embedded mode</h3>

<p>As describe above, to activate the embedded mode, you need to pass <code>embedded: true</code> when calling <code>AvMessagingSdk.init</code>. By doing so, you are disabling the auto-rendering mechanism and you will need to call <code>AvMessagingSdk.render</code> manually. This method accepts a DOM element which will be used as the container where the widget will be rendered.</p>

<div><pre><code class="language-javascript">AvMessagingSdk.init({
    integrationId: &#39;&lt;integration-id&gt;&#39;,
    embedded: true
});

AvMessagingSdk.render(document.getElementById(&#39;chat-container&#39;));</code></pre></div>

<p>The embedded widget will take full width and height of the container. You must give it a height, otherwise, the widget will collapse.</p>

<h3 id="toc_60">Authenticating the user: init() vs login()</h3>

<p>For authenticated user scenarios, a user&rsquo;s credentials can be passed in to either <code>init()</code> or <code>login()</code>. The question remains: when should you use which?</p>

<p>When <code>init()</code> is called without a <code>userId</code> and <code>jwt</code>, the UI will be initialized in an anonymous user context, and the user will be able to send messages as an anonymous user. After <code>init()</code> has completed, <code>login()</code> may be called to authenticate the user and resume any existing conversation. This is useful if you want your users to be able to send messages before they&rsquo;ve logged in to your website. Once a user does login and the browser is issued a valid <code>jwt</code>, <code>login()</code> may be called so that the user may continue the conversation in an authenticated session.</p>

<p>If however your use case requires that all users be logged in before they may send messages, then you should consider passing <code>userId</code> and <code>jwt</code> directly to the <code>init()</code> call upfront.</p>

<h2 id="toc_61">Content Security Policy</h2>

<p>If your deployment requires <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP">CSP compatibility</a>, add the following meta tag to your configuration.</p>

<div><pre><code class="language-markup">&lt;meta
    http-equiv=&quot;Content-Security-Policy&quot;
    content=&quot;
    connect-src
        wss://*.{{YOUR_DOMAIN_NAME}}
        https://*.{{YOUR_DOMAIN_NAME}};
    font-src
        https://*.{{YOUR_DOMAIN_NAME}};
    script-src
        https://*.{{YOUR_DOMAIN_NAME}};
    style-src
        https://*.{{YOUR_DOMAIN_NAME}};
    img-src
        blob:
        https://*.{{YOUR_DOMAIN_NAME}};&quot;
/&gt;</code></pre></div>

<p>Note that an equivalent configuration can be done <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy">server side</a>.</p>

<p>Note that your CSP configuration should also include any domains used to host images or files sent in messages.
If you require <code>blob:</code> to be excluded for <code>img-src</code>, you must disable the image upload feature via the <a href="#initoptions">init settings</a>.</p>

<h2 id="toc_62">Acknowledgements</h2>

<p><a href="https://github.com/lipis/flag-icon-css">https://github.com/lipis/flag-icon-css</a></p>



<script type="text/javascript">
var _self="undefined"!=typeof window?window:"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?self:{},Prism=function(){var e=/\blang(?:uage)?-(\w+)\b/i,t=0,n=_self.Prism={util:{encode:function(e){return e instanceof a?new a(e.type,n.util.encode(e.content),e.alias):"Array"===n.util.type(e)?e.map(n.util.encode):e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ")},type:function(e){return Object.prototype.toString.call(e).match(/\[object (\w+)\]/)[1]},objId:function(e){return e.__id||Object.defineProperty(e,"__id",{value:++t}),e.__id},clone:function(e){var t=n.util.type(e);switch(t){case"Object":var a={};for(var r in e)e.hasOwnProperty(r)&&(a[r]=n.util.clone(e[r]));return a;case"Array":return e.map&&e.map(function(e){return n.util.clone(e)})}return e}},languages:{extend:function(e,t){var a=n.util.clone(n.languages[e]);for(var r in t)a[r]=t[r];return a},insertBefore:function(e,t,a,r){r=r||n.languages;var l=r[e];if(2==arguments.length){a=arguments[1];for(var i in a)a.hasOwnProperty(i)&&(l[i]=a[i]);return l}var o={};for(var s in l)if(l.hasOwnProperty(s)){if(s==t)for(var i in a)a.hasOwnProperty(i)&&(o[i]=a[i]);o[s]=l[s]}return n.languages.DFS(n.languages,function(t,n){n===r[e]&&t!=e&&(this[t]=o)}),r[e]=o},DFS:function(e,t,a,r){r=r||{};for(var l in e)e.hasOwnProperty(l)&&(t.call(e,l,e[l],a||l),"Object"!==n.util.type(e[l])||r[n.util.objId(e[l])]?"Array"!==n.util.type(e[l])||r[n.util.objId(e[l])]||(r[n.util.objId(e[l])]=!0,n.languages.DFS(e[l],t,l,r)):(r[n.util.objId(e[l])]=!0,n.languages.DFS(e[l],t,null,r)))}},plugins:{},highlightAll:function(e,t){var a={callback:t,selector:'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'};n.hooks.run("before-highlightall",a);for(var r,l=a.elements||document.querySelectorAll(a.selector),i=0;r=l[i++];)n.highlightElement(r,e===!0,a.callback)},highlightElement:function(t,a,r){for(var l,i,o=t;o&&!e.test(o.className);)o=o.parentNode;o&&(l=(o.className.match(e)||[,""])[1],i=n.languages[l]),t.className=t.className.replace(e,"").replace(/\s+/g," ")+" language-"+l,o=t.parentNode,/pre/i.test(o.nodeName)&&(o.className=o.className.replace(e,"").replace(/\s+/g," ")+" language-"+l);var s=t.textContent,u={element:t,language:l,grammar:i,code:s};if(!s||!i)return n.hooks.run("complete",u),void 0;if(n.hooks.run("before-highlight",u),a&&_self.Worker){var c=new Worker(n.filename);c.onmessage=function(e){u.highlightedCode=e.data,n.hooks.run("before-insert",u),u.element.innerHTML=u.highlightedCode,r&&r.call(u.element),n.hooks.run("after-highlight",u),n.hooks.run("complete",u)},c.postMessage(JSON.stringify({language:u.language,code:u.code,immediateClose:!0}))}else u.highlightedCode=n.highlight(u.code,u.grammar,u.language),n.hooks.run("before-insert",u),u.element.innerHTML=u.highlightedCode,r&&r.call(t),n.hooks.run("after-highlight",u),n.hooks.run("complete",u)},highlight:function(e,t,r){var l=n.tokenize(e,t);return a.stringify(n.util.encode(l),r)},tokenize:function(e,t){var a=n.Token,r=[e],l=t.rest;if(l){for(var i in l)t[i]=l[i];delete t.rest}e:for(var i in t)if(t.hasOwnProperty(i)&&t[i]){var o=t[i];o="Array"===n.util.type(o)?o:[o];for(var s=0;s<o.length;++s){var u=o[s],c=u.inside,g=!!u.lookbehind,h=!!u.greedy,f=0,d=u.alias;u=u.pattern||u;for(var p=0;p<r.length;p++){var m=r[p];if(r.length>e.length)break e;if(!(m instanceof a)){u.lastIndex=0;var y=u.exec(m),v=1;if(!y&&h&&p!=r.length-1){var b=r[p+1].matchedStr||r[p+1],k=m+b;if(p<r.length-2&&(k+=r[p+2].matchedStr||r[p+2]),u.lastIndex=0,y=u.exec(k),!y)continue;var w=y.index+(g?y[1].length:0);if(w>=m.length)continue;var _=y.index+y[0].length,P=m.length+b.length;if(v=3,P>=_){if(r[p+1].greedy)continue;v=2,k=k.slice(0,P)}m=k}if(y){g&&(f=y[1].length);var w=y.index+f,y=y[0].slice(f),_=w+y.length,S=m.slice(0,w),O=m.slice(_),j=[p,v];S&&j.push(S);var A=new a(i,c?n.tokenize(y,c):y,d,y,h);j.push(A),O&&j.push(O),Array.prototype.splice.apply(r,j)}}}}}return r},hooks:{all:{},add:function(e,t){var a=n.hooks.all;a[e]=a[e]||[],a[e].push(t)},run:function(e,t){var a=n.hooks.all[e];if(a&&a.length)for(var r,l=0;r=a[l++];)r(t)}}},a=n.Token=function(e,t,n,a,r){this.type=e,this.content=t,this.alias=n,this.matchedStr=a||null,this.greedy=!!r};if(a.stringify=function(e,t,r){if("string"==typeof e)return e;if("Array"===n.util.type(e))return e.map(function(n){return a.stringify(n,t,e)}).join("");var l={type:e.type,content:a.stringify(e.content,t,r),tag:"span",classes:["token",e.type],attributes:{},language:t,parent:r};if("comment"==l.type&&(l.attributes.spellcheck="true"),e.alias){var i="Array"===n.util.type(e.alias)?e.alias:[e.alias];Array.prototype.push.apply(l.classes,i)}n.hooks.run("wrap",l);var o="";for(var s in l.attributes)o+=(o?" ":"")+s+'="'+(l.attributes[s]||"")+'"';return"<"+l.tag+' class="'+l.classes.join(" ")+'" '+o+">"+l.content+"</"+l.tag+">"},!_self.document)return _self.addEventListener?(_self.addEventListener("message",function(e){var t=JSON.parse(e.data),a=t.language,r=t.code,l=t.immediateClose;_self.postMessage(n.highlight(r,n.languages[a],a)),l&&_self.close()},!1),_self.Prism):_self.Prism;var r=document.currentScript||[].slice.call(document.getElementsByTagName("script")).pop();return r&&(n.filename=r.src,document.addEventListener&&!r.hasAttribute("data-manual")&&document.addEventListener("DOMContentLoaded",n.highlightAll)),_self.Prism}();"undefined"!=typeof module&&module.exports&&(module.exports=Prism),"undefined"!=typeof global&&(global.Prism=Prism);
</script>

<script type="text/javascript">
Prism.languages.markup={comment:/<!--[\w\W]*?-->/,prolog:/<\?[\w\W]+?\?>/,doctype:/<!DOCTYPE[\w\W]+?>/,cdata:/<!\[CDATA\[[\w\W]*?]]>/i,tag:{pattern:/<\/?(?!\d)[^\s>\/=.$<]+(?:\s+[^\s>\/=]+(?:=(?:("|')(?:\\\1|\\?(?!\1)[\w\W])*\1|[^\s'">=]+))?)*\s*\/?>/i,inside:{tag:{pattern:/^<\/?[^\s>\/]+/i,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"attr-value":{pattern:/=(?:('|")[\w\W]*?(\1)|[^\s>]+)/i,inside:{punctuation:/[=>"']/}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:/&#?[\da-z]{1,8};/i},Prism.hooks.add("wrap",function(a){"entity"===a.type&&(a.attributes.title=a.content.replace(/&amp;/,"&"))}),Prism.languages.xml=Prism.languages.markup,Prism.languages.html=Prism.languages.markup,Prism.languages.mathml=Prism.languages.markup,Prism.languages.svg=Prism.languages.markup;
</script>

<script type="text/javascript">
Prism.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\w\W]*?\*\//,lookbehind:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0}],string:{pattern:/(["'])(\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/((?:\b(?:class|interface|extends|implements|trait|instanceof|new)\s+)|(?:catch\s+\())[a-z0-9_\.\\]+/i,lookbehind:!0,inside:{punctuation:/(\.|\\)/}},keyword:/\b(if|else|while|do|for|return|in|instanceof|function|new|try|throw|catch|finally|null|break|continue)\b/,"boolean":/\b(true|false)\b/,"function":/[a-z0-9_]+(?=\()/i,number:/\b-?(?:0x[\da-f]+|\d*\.?\d+(?:e[+-]?\d+)?)\b/i,operator:/--?|\+\+?|!=?=?|<=?|>=?|==?=?|&&?|\|\|?|\?|\*|\/|~|\^|%/,punctuation:/[{}[\];(),.:]/};
</script>

<script type="text/javascript">
Prism.languages.javascript=Prism.languages.extend("clike",{keyword:/\b(as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|var|void|while|with|yield)\b/,number:/\b-?(0x[\dA-Fa-f]+|0b[01]+|0o[0-7]+|\d*\.?\d+([Ee][+-]?\d+)?|NaN|Infinity)\b/,"function":/[_$a-zA-Z\xA0-\uFFFF][_$a-zA-Z0-9\xA0-\uFFFF]*(?=\()/i}),Prism.languages.insertBefore("javascript","keyword",{regex:{pattern:/(^|[^\/])\/(?!\/)(\[.+?]|\\.|[^\/\\\r\n])+\/[gimyu]{0,5}(?=\s*($|[\r\n,.;})]))/,lookbehind:!0,greedy:!0}}),Prism.languages.insertBefore("javascript","class-name",{"template-string":{pattern:/`(?:\\\\|\\?[^\\])*?`/,greedy:!0,inside:{interpolation:{pattern:/\$\{[^}]+\}/,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:Prism.languages.javascript}},string:/[\s\S]+/}}}),Prism.languages.markup&&Prism.languages.insertBefore("markup","tag",{script:{pattern:/(<script[\w\W]*?>)[\w\W]*?(?=<\/script>)/i,lookbehind:!0,inside:Prism.languages.javascript,alias:"language-javascript"}}),Prism.languages.js=Prism.languages.javascript;
</script>


</body>

</html>
